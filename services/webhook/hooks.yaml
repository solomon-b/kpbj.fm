- id: restart-icecast
  execute-command: '{{ getenv "RESTART_CMD" }}'
  command-working-directory: /
  pass-arguments-to-command:
    - source: string
      name: restart
    - source: string
      name: '{{ getenv "ICECAST_SERVICE" }}'
  trigger-rule:
    match:
      type: value
      value: '{{ getenv "WEBHOOK_SECRET" }}'
      parameter:
        source: header
        name: X-Webhook-Secret

- id: restart-liquidsoap
  execute-command: '{{ getenv "RESTART_CMD" }}'
  command-working-directory: /
  pass-arguments-to-command:
    - source: string
      name: restart
    - source: string
      name: '{{ getenv "LIQUIDSOAP_SERVICE" }}'
  trigger-rule:
    match:
      type: value
      value: '{{ getenv "WEBHOOK_SECRET" }}'
      parameter:
        source: header
        name: X-Webhook-Secret

- id: force-play-episode
  execute-command: '{{ getenv "FORCE_PLAY_CMD" }}'
  command-working-directory: /
  pass-arguments-to-command:
    - source: payload
      name: url
    - source: payload
      name: title
    - source: payload
      name: artist
  trigger-rule:
    match:
      type: value
      value: '{{ getenv "WEBHOOK_SECRET" }}'
      parameter:
        source: header
        name: X-Webhook-Secret

- id: skip-track
  execute-command: '{{ getenv "SKIP_TRACK_CMD" }}'
  command-working-directory: /
  trigger-rule:
    match:
      type: value
      value: '{{ getenv "WEBHOOK_SECRET" }}'
      parameter:
        source: header
        name: X-Webhook-Secret

- id: stop-stream
  execute-command: '{{ getenv "STOP_STREAM_CMD" }}'
  command-working-directory: /
  trigger-rule:
    match:
      type: value
      value: '{{ getenv "WEBHOOK_SECRET" }}'
      parameter:
        source: header
        name: X-Webhook-Secret

- id: start-stream
  execute-command: '{{ getenv "START_STREAM_CMD" }}'
  command-working-directory: /
  trigger-rule:
    match:
      type: value
      value: '{{ getenv "WEBHOOK_SECRET" }}'
      parameter:
        source: header
        name: X-Webhook-Secret

- id: health
  execute-command: /bin/echo
  pass-arguments-to-command:
    - source: string
      name: ok
